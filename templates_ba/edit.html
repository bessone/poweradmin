<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="index.php">{% trans %}Home{% endtrans %}</a></li>
        <li class="breadcrumb-item"><a href="index.php?page=list_zones">{% trans %}Zones{% endtrans %}</a></li>
        <li class="breadcrumb-item">
            {% if idn_zone_name %}
            {{ idn_zone_name }}
            {% else %}
            {{ zone_name_to_display }}
            {% endif %}
        </li>
        <li class="breadcrumb-item" aria-current="page">{% trans %}Edit{% endtrans %}</li>
    </ol>
</nav>

<div class="card">
    <div class="card-header">
        <div class="float-start">
        {% if idn_zone_name %}
        <h5>{% trans %}Edit zone{% endtrans %} "{{ idn_zone_name }}" ({{ zone_name_to_display }})</h5>
        {% else %}
        <h5>{% trans %}Edit zone{% endtrans %} "{{ zone_name_to_display }}"</h5>
        {% endif %}
        </div>


        <div class="dropdown float-end">
            <i class="bi bi-three-dots-vertical btn btn-link text-body" data-bs-toggle="dropdown" aria-expanded="false"></i>
            <div class="dropdown-menu">
                {% if (perm_edit == "all" or (perm_edit == "own" or perm_edit == "own_as_client") and user_is_zone_owner == "1") and domain_type != "SLAVE" %}
                <a class="dropdown-item" href="index.php?page=add_record&id={{ zone_id }}" title="{% trans %}Add record{% endtrans %}">
                    <i class="bi bi-plus-circle text-primary"></i> {% trans %}Add record{% endtrans %}
                </a>
                {% endif %}
                {% if perm_edit == "all" or (perm_edit == "own" and user_is_zone_owner) %}
                <a class="dropdown-item" href="index.php?page=delete_domain&id={{ zone_id }}" title="{% trans %}Delete{% endtrans %}">
                    <i class="bi bi-trash text-danger"></i> {% trans %}Delete{% endtrans %}
                </a>
                {% endif %}
            </div>
        </div>

    </div>
    <div class="card-body">
        <div>
            {{ pagination | raw }}
        </div>

        {% if not records %}
        <table class="table table-striped table-hover table-sm">
            <tr>
                <td>{% trans %}This zone does not have any records.{% endtrans %}</td>
            </tr>
        </table>
        <hr>
        {% else %}

        {% if (perm_edit == "all" or (perm_edit == "own" or perm_edit == "own_as_client") and user_is_zone_owner == "1") and domain_type != "SLAVE" and iface_edit_add_record_top %}
        <form class="needs-validation" method="post" action="index.php?page=add_record&id={{ zone_id }}" novalidate>
            <input type="hidden" name="_token" value="{{ csrf_token }}">
            <input type="hidden" name="domain" value="{{ zone_id }}">
            <table class="table table-striped table-hover table-sm">
                <thead>
                <tr>
                    {% if iface_edit_show_id %}
                    <th>&nbsp;</th>
                    {% endif %}
                    <th>{% trans %}Name{% endtrans %}</th>
                    <th>{% trans %}Type{% endtrans %}</th>
                    <th>{% trans %}Content{% endtrans %}</th>
                    <th>{% trans %}Priority{% endtrans %}</th>
                    <th>{% trans %}TTL{% endtrans %}</th>
                    <th class="text-center">
                        {% if not is_reverse_zone and iface_add_reverse_record %}
                            {% trans %}Add PTR{% endtrans %}
                        {% endif %}
                        {% if is_reverse_zone and iface_add_domain_record %}
                            {% trans %}Add A/AAAA{% endtrans %}
                        {% endif %}
                    </th>
                    <th></th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    {% if iface_edit_show_id %}
                    <td>&nbsp;</td>
                    {% endif %}
                    <td>
                        <input class="form-control form-control-sm" type="text" name="name" value="">
                    </td>
                    <td>
                        <select id="recordTypeSelectTop" class="form-select form-select-sm w-auto" name="type" onchange="updateContentInput('recordTypeSelectTop', 'contentInputContainerTop', 'recordContentTop')">
                            {% set rev = false %}
                            {% for record_type in record_types %}
                            {% set add = "" %}
                            {% if is_reverse_zone and record_type == "PTR" %}
                            {% set add = "SELECTED" %}
                            {% endif %}

                            {% if iface_add_reverse_record and record_type == "A" %}
                            {% set add = "SELECTED" %}
                            {% set rev = true %}
                            {% endif %}
                            <option {{ add }} value="{{ record_type }}">{{ record_type }}</option>
                            {% endfor %}
                        </select>
                    </td>
                    <td>
                        <div id="contentInputContainerTop">
                            <input id="recordContentTop" class="form-control form-control-sm" type="text" name="content" value="" required>
                        </div>
                        <div class="invalid-feedback">{% trans %}Provide content{% endtrans %}</div>
                    </td>
                    <td><input class="form-control form-control-sm" type="number" name="prio" value="0" min="0" max="65535" pattern="[0-9]*"></td>
                    <td><input class="form-control form-control-sm" type="number" name="ttl" min="0" max="2147483647" pattern="[0-9]*" value="{{ dns_ttl }}" required>
                        <div class="invalid-feedback">{% trans %}Provide TTL{% endtrans %}</div>
                    </td>
                    <td class="text-center">
                        {% if not is_reverse_zone and iface_add_reverse_record %}
                        <span class="align-middle">
                            <input class="form-check-input" type="checkbox" name="reverse">
                        </span>
                        {% endif %}
                        {% if is_reverse_zone and iface_add_domain_record %}
                        <span class="align-middle">
                            <input class="form-check-input" type="checkbox" name="create_domain_record">
                        </span>
                        {% endif %}
                    </td>
                    <td>
                        <button class="btn btn-primary btn-sm" type="submit" name="commit">
                            <i class="bi bi-floppy"></i> {% trans %}Add record{% endtrans %}
                        </button>
                    </td>
                </tr>
                </tbody>
            </table>
        </form>
        <hr>
        {% endif %}

        <form class="needs-validation" method="post" action="" novalidate>
            <input type="hidden" name="_token" value="{{ csrf_token }}">
            <input type="hidden" name="serial" value="{{ serial }}">
            <div class="table-responsive">
            <table class="table table-striped table-hover table-sm">
                <thead>
                <tr>
                    {% if iface_edit_show_id %}
                    <th>
                        <a href="index.php?page=edit&id={{ zone_id }}&record_sort_by=id&sort_direction={{ record_sort_by == 'id' and sort_direction == 'ASC' ? 'DESC' : 'ASC' }}">
                            {% trans %}Id{% endtrans %}
                        </a>
                        {% if record_sort_by == 'id' %}
                            <i class="bi bi-arrow-{{ sort_direction == 'ASC' ? 'down' : 'up' }}"></i>
                        {% endif %}
                    </th>
                    {% endif %}
                    <th>
                        <a href="index.php?page=edit&id={{ zone_id }}&record_sort_by=name&sort_direction={{ record_sort_by == 'name' and sort_direction == 'ASC' ? 'DESC' : 'ASC' }}">
                            {% trans %}Name{% endtrans %}
                        </a>
                        {% if record_sort_by == 'name' %}
                            <i class="bi bi-arrow-{{ sort_direction == 'ASC' ? 'down' : 'up' }}"></i>
                        {% endif %}
                    </th>
                    <th>
                        <a href="index.php?page=edit&id={{ zone_id }}&record_sort_by=type&sort_direction={{ record_sort_by == 'type' and sort_direction == 'ASC' ? 'DESC' : 'ASC' }}">
                            {% trans %}Type{% endtrans %}
                        </a>
                        {% if record_sort_by == 'type' %}
                            <i class="bi bi-arrow-{{ sort_direction == 'ASC' ? 'down' : 'up' }}"></i>
                        {% endif %}
                    </th>
                    <th>
                        <a href="index.php?page=edit&id={{ zone_id }}&record_sort_by=content&sort_direction={{ record_sort_by == 'content' and sort_direction == 'ASC' ? 'DESC' : 'ASC' }}">
                            {% trans %}Content{% endtrans %}
                        </a>
                        {% if record_sort_by == 'content' %}
                            <i class="bi bi-arrow-{{ sort_direction == 'ASC' ? 'down' : 'up' }}"></i>
                        {% endif %}
                    </th>
                    <th>
                        <a href="index.php?page=edit&id={{ zone_id }}&record_sort_by=prio&sort_direction={{ record_sort_by == 'prio' and sort_direction == 'ASC' ? 'DESC' : 'ASC' }}">
                            {% trans %}Priority{% endtrans %}
                        </a>
                        {% if record_sort_by == 'prio' %}
                            <i class="bi bi-arrow-{{ sort_direction == 'ASC' ? 'down' : 'up' }}"></i>
                        {% endif %}
                    </th>
                    <th>
                        <a href="index.php?page=edit&id={{ zone_id }}&record_sort_by=ttl&sort_direction={{ record_sort_by == 'ttl' and sort_direction == 'ASC' ? 'DESC' : 'ASC' }}">
                            {% trans %}TTL{% endtrans %}
                        </a>
                        {% if record_sort_by == 'ttl' %}
                            <i class="bi bi-arrow-{{ sort_direction == 'ASC' ? 'down' : 'up' }}"></i>
                        {% endif %}
                    </th>
                    <th class="text-center">
                        <a href="index.php?page=edit&id={{ zone_id }}&record_sort_by=disabled&sort_direction={{ record_sort_by == 'disabled' and sort_direction == 'ASC' ? 'DESC' : 'ASC' }}">
                            {% trans %}Disabled{% endtrans %}
                        </a>
                        {% if record_sort_by == 'disabled' %}
                            <i class="bi bi-arrow-{{ sort_direction == 'ASC' ? 'down' : 'up' }}"></i>
                        {% endif %}
                    </th>
                    <th>&nbsp;</th>
                </tr>
                </thead>
                <tbody>
                {% for r in records %}

                {% if not(r['type'] == "SOA" or (r['type'] == "NS" and perm_edit == "own_as_client")) %}
                <input type="hidden" name="record[{{ r['id'] }}][rid]" value="{{ r['id'] }}">
                <input type="hidden" name="record[{{ r['id'] }}][zid]" value="{{ zone_id }}">
                {% endif %}
                <tr>
                    {% if iface_edit_show_id %}
                    <td>{{ r['id'] }}</td>
                    {% endif %}
                    {% if r['type'] == "SOA" or r['type'] == "NS" and perm_edit == "own_as_client" %}
                    <td>{{ r['name'] }}</td>
                    <td>{{ r['type'] }}</td>
                    <td>{{ r['content'] }}</td>
                    <td>&nbsp;</td>
                    <td>{{ r['ttl'] }}</td>
                    <td>&nbsp;</td>
                    {% else %}
                    <td>
                        <div class="input-group input-group-sm">
                            <input type="text" class="form-control form-control-sm" style="min-width: 100px" name="record[{{ r['id'] }}][name]" value="{{ r['name']|replace({(zone_name) : ''})|trim('.') }}">
                            <span class="input-group-text">.{{ idn_zone_name ?: zone_name }}</span>
                        </div>
                    </td>
                    <td>
                        <select id="recordTypeSelect{{ r['id'] }}" class="form-select form-select-sm w-auto" name="record[{{ r['id'] }}][type]" onchange="updateContentInput('recordTypeSelect{{ r['id'] }}', 'contentInputContainer{{ r['id'] }}', 'recordContent{{ r['id'] }}')">
                            {% set found_selected_type = false %}
                            {% for type_available in types %}
                            {% if type_available == r['type'] %}
                            {% set add = "SELECTED" %}
                            {% set found_selected_type = true %}
                            {% else %}
                            {% set add = "" %}
                            {% endif %}
                            <option {{ add }} value="{{ type_available }}">{{ type_available }}</option>
                            {% endfor %}
                            {% if not found_selected_type %}
                            <option selected value="{{ r['type'] }}">{{ r['type'] }}</option>
                            {% endif %}
                        </select>
                    </td>
                    <td>
                        <div id="contentInputContainer{{ r['id'] }}">
                            <input id="recordContent{{ r['id'] }}" class="form-control form-control-sm" type="text" name="record[{{ r['id'] }}][content]" value="{{ r['content'] }}">
                        </div>
                    </td>
                    <td>
                        <input class="form-control form-control-sm" type="number"
                                                id="priority_field_{{ r['id'] }}" name="record[{{ r['id'] }}][prio]"
                                                min="0" max="65535" pattern="[0-9]*" value="{{ r['prio'] }}">
                    </td>
                    <td>
                        <input class="form-control form-control-sm" type="number"
                                                min="0" max="2147483647" pattern="[0-9]*" name="record[{{ r['id'] }}][ttl]"
                                                value="{{ r['ttl'] }}">
                    </td>
                    <td class="text-center">
                        <input class="form-check-input" type="checkbox" name="record[{{ r['id'] }}][disabled]" {% if r['disabled'] == 1 %}checked{% endif %}>
                    </td>
                    {% endif %}

                    {% if domain_type == "SLAVE" or perm_edit == "none" or (perm_edit == "own" or perm_edit == "own_as_client") and user_is_zone_owner == "0" %}
                    <td>&nbsp;</td>
                    {% elseif r['type'] == "SOA" and perm_edit != "all" or r['type'] == "NS" and perm_edit == "own_as_client" %}
                    <td>&nbsp;</td>
                    {% else %}
                    <td class="text-end">
                        <a class="btn btn-outline-primary btn-sm" href="index.php?page=edit_record&id={{ r['id'] }}&domain={{ zone_id }}">
                            <i class="bi bi-pencil-square"></i> {% trans %}Edit{% endtrans %}
                        </a>
                        <a class="btn btn-outline-danger btn-sm" href="index.php?page=delete_record&id={{ r['id'] }}&domain={{ zone_id }}">
                            <i class="bi bi-trash"></i> {% trans %}Delete{% endtrans %}
                        </a>
                    </td>
                    {% endif %}
                </tr>
                {% endfor %}
                </tbody>
            </table>
            </div>
            {% if iface_zone_comments %}
            <div class="row">
                <div class="col">
                    <label for="comment">{% trans %}Comments{% endtrans %}</label>
                    <textarea class="form-control form-control-sm" rows="5" cols="80" name="comment">{{ zone_comment }}</textarea>
                </div>
                <div class="col-auto align-self-end">
                    <a class="btn btn-outline-primary btn-sm" href="index.php?page=edit_comment&id={{ zone_id }}">
                        <i class="bi bi-pencil-square"></i> {% trans %}Edit comment{% endtrans %}
                    </a>
                </div>
            </div>
            {% endif %}
            <div class="mt-3">
                {% if perm_edit != "none" %}
                <button class="btn btn-primary btn-sm" type="submit" name="commit">
                    <i class="bi bi-floppy"></i> {% trans %}Update{% endtrans %}
                </button>
                <button class="btn btn-secondary btn-sm" type="reset" name="reset">
                    <i class="bi bi-arrow-counterclockwise"></i> {% trans %}Reset{% endtrans %}
                </button>
                {% endif %}
            </div>
        </form>
    </div>
</div>
{% endif %}

{% if perm_edit == "all" or (perm_edit == "own" or perm_edit == "own_as_client") and user_is_zone_owner == "1" %}
{% if domain_type != "SLAVE" and not iface_edit_add_record_top %}
<div class="card mt-4">
    <div class="card-header">
        <h5>{% trans %}Add record{% endtrans %}</h5>
    </div>
    <div class="card-body">
        <form class="needs-validation" method="post" action="index.php?page=add_record&id={{ zone_id }}" novalidate>
            <input type="hidden" name="_token" value="{{ csrf_token }}">
            <input type="hidden" name="domain" value="{{ zone_id }}">
            <div class="table-responsive">
            <table class="table table-striped table-hover table-sm">
                <thead>
                <tr>
                    <th>{% trans %}Name{% endtrans %}</th>
                    <th>&nbsp;</th>
                    <th>{% trans %}Type{% endtrans %}</th>
                    <th>{% trans %}Content{% endtrans %}</th>
                    <th>{% trans %}Priority{% endtrans %}</th>
                    <th>{% trans %}TTL{% endtrans %}</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td>
                        <div class="input-group input-group-sm">
                            <input type="text" class="form-control form-control-sm" style="min-width: 100px" name="name" value="" data-testid="record-name-input">
                            <span class="input-group-text">.{{ idn_zone_name ?: zone_name }}</span>
                        </div>
                    </td>
                    <td>IN</td>
                    <td>
                        <select id="recordTypeSelectBottom" class="form-select form-select-sm" name="type" onchange="updateContentInput('recordTypeSelectBottom', 'contentInputContainerBottom', 'recordContentBottom')">
                            {% set rev = false %}
                            {% for record_type in record_types %}
                            {% set add = "" %}
                            {% if is_reverse_zone and record_type == "PTR" %}
                            {% set add = "SELECTED" %}
                            {% endif %}

                            {% if iface_add_reverse_record and record_type == "A" %}
                            {% set add = "SELECTED" %}
                            {% set rev = true %}
                            {% endif %}
                            <option {{ add }} value="{{ record_type }}">{{ record_type }}</option>
                            {% endfor %}
                        </select>
                    </td>
                    <td>
                        <div id="contentInputContainerBottom">
                            <input id="recordContentBottom" class="form-control form-control-sm" type="text" name="content" value="" data-testid="record-content-input" required>
                        </div>
                        <div class="invalid-feedback">{% trans %}Provide content{% endtrans %}</div>
                    </td>
                    <td>
                        <input class="form-control form-control-sm" type="number" name="prio" value="0" min="0" max="65535" pattern="[0-9]*">
                    </td>
                    <td>
                        <input class="form-control form-control-sm" type="number" name="ttl" min="0" max="2147483647" pattern="[0-9]*" value="{{ dns_ttl }}" required>
                        <div class="invalid-feedback">{% trans %}Provide TTL{% endtrans %}</div>
                    </td>
                </tr>
                </tbody>
            </table>
            </div>
            <button class="btn btn-primary btn-sm" type="submit" name="commit" data-testid="add-record-button">
                <i class="bi bi-floppy"></i> {% trans %}Add record{% endtrans %}
            </button>

            {% if not is_reverse_zone and iface_add_reverse_record %}
            <span class="align-middle">
                &nbsp;
                <input class="form-check-input" type="checkbox" name="reverse" data-testid="add-reverse-record-checkbox">
                <span class="text-secondary"> {% trans %}Also add a PTR record in the matching zone{% endtrans %}</span>
            </span>
            {% endif %}
            {% if is_reverse_zone and iface_add_domain_record %}
            <span class="align-middle">
                &nbsp;
                <input class="form-check-input" type="checkbox" name="create_domain_record" data-testid="add-domain-record-checkbox">
                <span class="text-secondary"> {% trans %}Also add an A/AAAA record in the matching zone{% endtrans %}</span>
            </span>
            {% endif %}
        </form>
    </div>
</div>
{% endif %}



<div class="card mt-4">
    <div class="card-header">
        <h5>{% trans %}Tools{% endtrans %}</h5>
    </div>
    <div class="card-body">
        <ul class="nav nav-tabs" id="toolsTab" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="type-tab" data-bs-toggle="tab" data-bs-target="#type-tab-pane" type="button"
                    role="tab" aria-controls="type-tab-pane" aria-selected="false">
                    {% trans %}Type{% endtrans %}
                </button>
            </li>
            {% if domain_type == "SLAVE" %}
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="master-tab" data-bs-toggle="tab" data-bs-target="#master-tab-pane" type="button"
                    role="tab" aria-controls="master-tab-pane" aria-selected="false">
                    {% trans %}IP address of master NS{% endtrans %}
                </button>
            </li>
            {% endif %}
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="template-tab" data-bs-toggle="tab" data-bs-target="#template-tab-pane"
                    type="button" role="tab" aria-controls="template-tab-pane" aria-selected="true">
                    {% trans %}Template{% endtrans %}
                </button>
            </li>
            {% if perm_zone_master_add and domain_type != "SLAVE"%}
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="new-template-tab" data-bs-toggle="tab" data-bs-target="#new-template-tab-pane"
                    type="button" role="tab" aria-controls="new-template-tab-pane" aria-selected="true">
                    {% trans %}Save as new template{% endtrans %}
                </button>
            </li>
            {% endif %}
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="owner-tab" data-bs-toggle="tab" data-bs-target="#owner-tab-pane"
                    type="button" role="tab" aria-controls="owner-tab-pane" aria-selected="false">
                    {% trans %}Owner of zone{% endtrans %}
                </button>
            </li>
            {% if pdnssec_use %}
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="dnssec-tab" data-bs-toggle="tab" data-bs-target="#dnssec-tab-pane" type="button"
                    role="tab" aria-controls="dnssec-tab-pane" aria-selected="false">
                    {% trans %}DNSSEC{% endtrans %}
                </button>
            </li>
            {% endif %}
        </ul>
        <div class="tab-content border border-top-0" id="toolsTabContent">
            <div class="tab-pane fade show active p-3" id="type-tab-pane" role="tabpanel" aria-labelledby="type-tab" tabindex="0">
                {% if meta_edit %}
                <form action="index.php?page=edit&id={{ zone_id }}" method="post" class="col-12 col-xxl-4 col-xl-6">
                    <input type="hidden" name="_token" value="{{ csrf_token }}">
                    <input type="hidden" name="domain" value="{{ zone_id }}">
                    <div class="">
                        <select class="form-select form-select-sm" name="newtype">
                            {% for type in zone_types %}
                            {% set add = '' %}
                            {% if type == domain_type %}
                            {% set add = "SELECTED" %}
                            {% endif %}
                            <option {{ add }} value="{{ type }}">{{ type | lower }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="mt-3">
                        <button class="btn btn-primary btn-sm" type="submit" name="type_change">
                            <i class="bi bi-floppy"></i> {% trans %}Change{% endtrans %}
                        </button>
                    </div>
                </form>
                {% else %}
                    {{ domain_type | lower }}
                {% endif %}
            </div>
            {% if domain_type == "SLAVE" %}
            <div class="tab-pane fade p-3" id="master-tab-pane" role="tabpanel" aria-labelledby="master-tab" tabindex="0">
                {% if meta_edit %}
                <form class="col-12 col-xxl-4 col-xl-6" action="index.php?page=edit&id={{ zone_id }}" method="post">
                    <input type="hidden" name="_token" value="{{ csrf_token }}">
                    <input type="hidden" name="domain" value="{{ zone_id }}">
                    <div>
                        <label class="form-label">{% trans %}IP address of master NS{% endtrans %}</label>
                        <input class="form-control form-control-sm" type="text" name="new_master" value="{{ slave_master }}">
                    </div>
                    <div class="mt-3">
                        <button class="btn btn-primary btn-sm" type="submit" name="slave_master_change">
                            <i class="bi bi-floppy"></i> {% trans %}Change{% endtrans %}
                        </button>
                    </div>
                </form>
                {% else %}
                    {{ slave_master }}
                {% endif %}
            </div>
            {% endif %}
            <div class="tab-pane fade p-3" id="template-tab-pane" role="tabpanel" aria-labelledby="new-template-tab" tabindex="0">
                {% if meta_edit %}
                <form class="col-12 col-xxl-4 col-xl-6" action="index.php?page=edit&id={{ zone_id }}" method="post">
                    <input type="hidden" name="_token" value="{{ csrf_token }}">
                    <input type="hidden" name="current_zone_template" value="{{ zone_template_id }}">
                    <div>
                        <select class="form-select form-select-sm" name="zone_template">
                            <option value="none">none</option>
                            {% for zone_template in zone_templates %}
                            {% set add = '' %}
                            {% if zone_template['id'] == zone_template_id %}
                            {% set add = "SELECTED" %}
                            {% endif %}
                            <option {{ add }} value="{{ zone_template['id'] }}">{{ zone_template['name'] }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="mt-3">
                        <button class="btn btn-primary btn-sm" type="submit" name="template_change">
                            <i class="bi bi-floppy"></i> {% trans %}Change{% endtrans %}
                        </button>
                    </div>
                </form>
                {% else %}
                    {% if zone_template_details %}
                    {{ zone_template_details['name'] | lower }}
                    {% else %}
                    none
                    {% endif %}
                {% endif %}
            </div>
            {% if perm_zone_master_add and domain_type != "SLAVE"%}
            <div class="tab-pane fade p-3" id="new-template-tab-pane" role="tabpanel" aria-labelledby="new-template-tab" tabindex="0">
                <form class="needs-validation col-12 col-xxl-4 col-xl-6" method="post" action="" novalidate>
                    <input type="hidden" name="_token" value="{{ csrf_token }}">
                    <div>
                        <label class="form-label">{% trans %}Template Name{% endtrans %}</label>
                        <input class="form-control form-control-sm" type="text" name="templ_name" value="" required>
                        <div class="invalid-feedback">{% trans %}Provide template name{% endtrans %}</div>
                    </div>
                    <div class="mt-3">
                        <label class="form-label">{% trans %}Template Description{% endtrans %}</label>
                        <input class="form-control form-control-sm" type="text" name="templ_descr" value="">
                    </div>
                    <div class="mt-3">
                        <button class="btn btn-primary btn-sm" type="submit" name="save_as">
                            <i class="bi bi-floppy"></i> {% trans %}Save as template{% endtrans %}
                        </button>
                    </div>
                    {% endif %}
                </form>
            </div>
            {% endif %}
            <div class="tab-pane fade p-3" id="owner-tab-pane" role="tabpanel" aria-labelledby="owner-tab" tabindex="0">
                {% if owners == "-1" %}
                    {% trans %}No owner set for this zone.{% endtrans %}
                {% else %}
                    {% if meta_edit %}
                        {% for owner in owners %}
                        <form method="post" action="index.php?page=edit&id={{ zone_id }}" class="row mt-2">
                            <input type="hidden" name="_token" value="{{ csrf_token }}">
                            <div class="col-6 col-lg-4 col-xxl-3">
                                {% if owner["fullname"] %}
                                {{ owner["fullname"] }}
                                {% else %}
                                {{ owner["username"] }}
                                {% endif %}
                            </div>
                            <div class="col-2">
                                <input type="hidden" name="delete_owner" value="{{ owner['id'] }}">
                                <button class="btn btn-danger btn-sm" type="submit" name="co" title="{% trans %}Delete{% endtrans %}">
                                    <i class="bi bi-trash"></i>
                                </button>
                            </div>
                        </form>
                        {% endfor %}
                    {% else %}
                        {% for owner in owners %}
                        <tr>
                            <td>
                                {% if owner["fullname"] %}
                                {{ owner["fullname"] }}
                                {% else %}
                                {{ owner["username"] }}
                                {% endif %}
                            </td>
                            <td>&nbsp;</td>
                        </tr>
                        {% endfor %}
                    {% endif %}
                {% endif %}

                {% if meta_edit %}
                <form method="post" action="index.php?page=edit&id={{ zone_id }}" class="row mt-2">
                    <input type="hidden" name="_token" value="{{ csrf_token }}">
                    <input type="hidden" name="domain" value="{{ zone_id }}">
                    <div class="col-6 col-lg-4 col-xxl-3">
                        <select class="form-select form-select-sm" name="newowner">
                            {% for user in users %}
                            {% set add = "" %}
                            {% if user["id"] == session_userid %}
                            <option {{ add }} value="{{ user['id'] }}">{{ user["fullname"] }}</option>
                            {% elseif perm_view_others %}
                            <option value="{{ user['id'] }}">
                                {% if user["fullname"] %}
                                {{ user["fullname"] }}
                                {% else %}
                                {{ user["username"] }}
                                {% endif %}
                            </option>
                            {% endif %}
                            {% endfor %}
                        </select>
                    </div>
                    <div class="col-2">
                        <button class="btn btn-primary btn-sm" type="submit" name="co" title="{% trans %}Add{% endtrans %}">
                            <i class="bi bi-plus-circle"></i>
                        </button>
                    </div>
                </form>
                {% endif %}
            </div>
            {% if pdnssec_use %}
            <div class="tab-pane fade p-3" id="dnssec-tab-pane" role="tabpanel" aria-labelledby="dnssec-tab" tabindex="0">
                {% if is_secured %}
                <a class="btn btn-success btn-sm" href="index.php?page=dnssec&id={{ zone_id }}">
                    <i class="bi bi-lock-fill"></i> {% trans %}DNSSEC{% endtrans %}
                </a>
                <button class="btn btn-danger btn-sm" type="submit" name="unsign_zone">
                    <i class="bi bi-unlock-fill"></i> {% trans %}Unsign this zone{% endtrans %}
                </button>
                {% else %}
                <button class="btn btn-success btn-sm" type="submit" name="sign_zone">
                    <i class="bi bi-lock-fill"></i> {% trans %}Sign this zone{% endtrans %}
                </button>
                {% endif %}
            </div>
            {% endif %}
        </div>
    </div>
</div>

<script src="assets/textareaAutoResize.js?time={{ file_version }}"></script>
